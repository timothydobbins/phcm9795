<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Module 8 Correlation and linear regression | PHCM9795 Foundations of Biostatistics</title>
  <meta name="description" content="Module 8 Correlation and linear regression | PHCM9795 Foundations of Biostatistics" />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="Module 8 Correlation and linear regression | PHCM9795 Foundations of Biostatistics" />
  <meta property="og:type" content="book" />
  
  
  
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Module 8 Correlation and linear regression | PHCM9795 Foundations of Biostatistics" />
  
  
  

<meta name="author" content="Course notes" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="learning-activities-6.html"/>
<link rel="next" href="stata-notes-5.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>



<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">PHCM9795 Foundations of Biostatistics</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="introduction-to-statistics-and-presenting-data.html"><a href="introduction-to-statistics-and-presenting-data.html"><i class="fa fa-check"></i><b>1</b> Introduction to statistics and presenting data</a>
<ul>
<li class="chapter" data-level="" data-path="introduction-to-statistics-and-presenting-data.html"><a href="introduction-to-statistics-and-presenting-data.html#learning-objectives"><i class="fa fa-check"></i>Learning objectives</a></li>
<li class="chapter" data-level="" data-path="introduction-to-statistics-and-presenting-data.html"><a href="introduction-to-statistics-and-presenting-data.html#readings"><i class="fa fa-check"></i>Readings</a></li>
<li class="chapter" data-level="1.1" data-path="introduction-to-statistics-and-presenting-data.html"><a href="introduction-to-statistics-and-presenting-data.html#an-introduction-to-statistics"><i class="fa fa-check"></i><b>1.1</b> An introduction to statistics</a></li>
<li class="chapter" data-level="1.2" data-path="introduction-to-statistics-and-presenting-data.html"><a href="introduction-to-statistics-and-presenting-data.html#descriptive-and-inferential-statistics"><i class="fa fa-check"></i><b>1.2</b> Descriptive and inferential statistics</a></li>
<li class="chapter" data-level="1.3" data-path="introduction-to-statistics-and-presenting-data.html"><a href="introduction-to-statistics-and-presenting-data.html#variables"><i class="fa fa-check"></i><b>1.3</b> Variables</a></li>
<li class="chapter" data-level="1.4" data-path="introduction-to-statistics-and-presenting-data.html"><a href="introduction-to-statistics-and-presenting-data.html#presenting-data"><i class="fa fa-check"></i><b>1.4</b> Presenting data</a></li>
<li class="chapter" data-level="1.5" data-path="introduction-to-statistics-and-presenting-data.html"><a href="introduction-to-statistics-and-presenting-data.html#graphical-presentation"><i class="fa fa-check"></i><b>1.5</b> Graphical presentation</a></li>
<li class="chapter" data-level="1.6" data-path="introduction-to-statistics-and-presenting-data.html"><a href="introduction-to-statistics-and-presenting-data.html#summary-statistics-and-variation-in-data"><i class="fa fa-check"></i><b>1.6</b> Summary statistics and variation in data</a></li>
<li class="chapter" data-level="1.7" data-path="introduction-to-statistics-and-presenting-data.html"><a href="introduction-to-statistics-and-presenting-data.html#population-values-mean-variance-and-standard-deviation"><i class="fa fa-check"></i><b>1.7</b> Population values: mean, variance and standard deviation</a></li>
<li class="chapter" data-level="1.8" data-path="introduction-to-statistics-and-presenting-data.html"><a href="introduction-to-statistics-and-presenting-data.html#using-graphs-to-display-the-centre-and-spread-of-the-data"><i class="fa fa-check"></i><b>1.8</b> Using graphs to display the centre and spread of the data</a></li>
<li class="chapter" data-level="1.9" data-path="introduction-to-statistics-and-presenting-data.html"><a href="introduction-to-statistics-and-presenting-data.html#how-to-report-summary-statistics"><i class="fa fa-check"></i><b>1.9</b> How to report summary statistics</a></li>
</ul></li>
<li><a href="an-introduction-to-stata.html#an-introduction-to-stata"><strong>1</strong> An introduction to Stata</a>
<ul>
<li class="chapter" data-level="" data-path="an-introduction-to-stata.html"><a href="an-introduction-to-stata.html"><i class="fa fa-check"></i>Learning outcomes</a></li>
<li class="chapter" data-level="" data-path="an-introduction-to-stata.html"><a href="an-introduction-to-stata.html#introduction"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="" data-path="an-introduction-to-stata.html"><a href="an-introduction-to-stata.html#part-1-a-simple-stata-analysis"><i class="fa fa-check"></i>Part 1: A simple Stata analysis</a></li>
<li class="chapter" data-level="" data-path="an-introduction-to-stata.html"><a href="an-introduction-to-stata.html#part-2-obtaining-basic-descriptive-statistics"><i class="fa fa-check"></i>Part 2: Obtaining basic descriptive statistics</a></li>
<li class="chapter" data-level="" data-path="an-introduction-to-stata.html"><a href="an-introduction-to-stata.html#part-3-creating-other-types-of-graphs"><i class="fa fa-check"></i>Part 3: Creating other types of graphs</a></li>
</ul></li>
<li><a href="learning-activities.html#learning-activities"><strong>1</strong> Learning Activities</a></li>
<li class="chapter" data-level="2" data-path="probability-and-probability-distributions.html"><a href="probability-and-probability-distributions.html"><i class="fa fa-check"></i><b>2</b> Probability and probability distributions</a>
<ul>
<li class="chapter" data-level="" data-path="probability-and-probability-distributions.html"><a href="probability-and-probability-distributions.html#learning-objectives-1"><i class="fa fa-check"></i>Learning objectives</a></li>
<li class="chapter" data-level="" data-path="probability-and-probability-distributions.html"><a href="probability-and-probability-distributions.html#readings-1"><i class="fa fa-check"></i>Readings</a></li>
<li class="chapter" data-level="2.1" data-path="probability-and-probability-distributions.html"><a href="probability-and-probability-distributions.html#introduction-1"><i class="fa fa-check"></i><b>2.1</b> Introduction</a></li>
<li class="chapter" data-level="2.2" data-path="probability-and-probability-distributions.html"><a href="probability-and-probability-distributions.html#probability"><i class="fa fa-check"></i><b>2.2</b> Probability</a></li>
<li class="chapter" data-level="2.3" data-path="probability-and-probability-distributions.html"><a href="probability-and-probability-distributions.html#probability-distributions"><i class="fa fa-check"></i><b>2.3</b> Probability distributions</a></li>
<li class="chapter" data-level="2.4" data-path="probability-and-probability-distributions.html"><a href="probability-and-probability-distributions.html#discrete-variables-and-their-probability-distributions"><i class="fa fa-check"></i><b>2.4</b> Discrete variables and their probability distributions</a></li>
<li class="chapter" data-level="2.5" data-path="probability-and-probability-distributions.html"><a href="probability-and-probability-distributions.html#binomial-distribution"><i class="fa fa-check"></i><b>2.5</b> Binomial distribution</a></li>
<li class="chapter" data-level="2.6" data-path="probability-and-probability-distributions.html"><a href="probability-and-probability-distributions.html#normal-distribution"><i class="fa fa-check"></i><b>2.6</b> Normal distribution</a></li>
<li class="chapter" data-level="2.7" data-path="probability-and-probability-distributions.html"><a href="probability-and-probability-distributions.html#the-standard-normal-distribution"><i class="fa fa-check"></i><b>2.7</b> The Standard Normal distribution</a></li>
<li class="chapter" data-level="2.8" data-path="probability-and-probability-distributions.html"><a href="probability-and-probability-distributions.html#assessing-normality"><i class="fa fa-check"></i><b>2.8</b> Assessing Normality</a></li>
<li class="chapter" data-level="2.9" data-path="probability-and-probability-distributions.html"><a href="probability-and-probability-distributions.html#non-normally-distributed-measurements"><i class="fa fa-check"></i><b>2.9</b> Non-Normally distributed measurements</a></li>
<li class="chapter" data-level="2.10" data-path="probability-and-probability-distributions.html"><a href="probability-and-probability-distributions.html#parametric-and-non-parametric-statistical-methods"><i class="fa fa-check"></i><b>2.10</b> Parametric and non-parametric statistical methods</a></li>
<li class="chapter" data-level="2.11" data-path="probability-and-probability-distributions.html"><a href="probability-and-probability-distributions.html#other-types-of-probability-distributions"><i class="fa fa-check"></i><b>2.11</b> Other types of probability distributions</a></li>
</ul></li>
<li><a href="stata-notes.html#stata-notes"><strong>2</strong> Stata notes</a>
<ul>
<li class="chapter" data-level="2.12" data-path="stata-notes.html"><a href="stata-notes.html"><i class="fa fa-check"></i><b>2.12</b> Importing data into Stata</a></li>
<li class="chapter" data-level="2.13" data-path="stata-notes.html"><a href="stata-notes.html#checking-your-data-for-errors-in-stata"><i class="fa fa-check"></i><b>2.13</b> Checking your data for errors in Stata</a></li>
<li class="chapter" data-level="2.14" data-path="stata-notes.html"><a href="stata-notes.html#overlaying-a-normal-curve-on-a-histogram"><i class="fa fa-check"></i><b>2.14</b> Overlaying a Normal curve on a Histogram</a></li>
<li class="chapter" data-level="2.15" data-path="stata-notes.html"><a href="stata-notes.html#descriptive-statistics-for-checking-normality"><i class="fa fa-check"></i><b>2.15</b> Descriptive statistics for checking normality</a></li>
<li class="chapter" data-level="2.16" data-path="stata-notes.html"><a href="stata-notes.html#importing-excel-data-into-stata"><i class="fa fa-check"></i><b>2.16</b> Importing Excel data into Stata</a></li>
<li class="chapter" data-level="2.17" data-path="stata-notes.html"><a href="stata-notes.html#generating-new-variables"><i class="fa fa-check"></i><b>2.17</b> Generating new variables</a></li>
<li class="chapter" data-level="2.18" data-path="stata-notes.html"><a href="stata-notes.html#summarising-data-by-another-variable"><i class="fa fa-check"></i><b>2.18</b> Summarising data by another variable</a></li>
<li class="chapter" data-level="2.19" data-path="stata-notes.html"><a href="stata-notes.html#recoding-data"><i class="fa fa-check"></i><b>2.19</b> Recoding data</a></li>
<li class="chapter" data-level="2.20" data-path="stata-notes.html"><a href="stata-notes.html#computing-binomial-probabilities-using-the-hand-calculator-in-stata"><i class="fa fa-check"></i><b>2.20</b> Computing binomial probabilities using the Hand calculator in Stata</a></li>
<li class="chapter" data-level="2.21" data-path="stata-notes.html"><a href="stata-notes.html#computing-probabilities-from-the-normal-distribution-using-the-hand-calculator-in-stata"><i class="fa fa-check"></i><b>2.21</b> Computing probabilities from the normal distribution using the Hand calculator in Stata</a></li>
</ul></li>
<li><a href="learning-activities-1.html#learning-activities-1"><strong>2</strong> Learning Activities</a></li>
<li class="chapter" data-level="3" data-path="precision-standard-errors-and-confidence-intervals.html"><a href="precision-standard-errors-and-confidence-intervals.html"><i class="fa fa-check"></i><b>3</b> Precision, standard errors and confidence intervals</a>
<ul>
<li class="chapter" data-level="" data-path="precision-standard-errors-and-confidence-intervals.html"><a href="precision-standard-errors-and-confidence-intervals.html#learning-objectives-2"><i class="fa fa-check"></i>Learning objectives</a></li>
<li class="chapter" data-level="" data-path="precision-standard-errors-and-confidence-intervals.html"><a href="precision-standard-errors-and-confidence-intervals.html#readings-2"><i class="fa fa-check"></i>Readings</a></li>
<li class="chapter" data-level="3.1" data-path="precision-standard-errors-and-confidence-intervals.html"><a href="precision-standard-errors-and-confidence-intervals.html#introduction-2"><i class="fa fa-check"></i><b>3.1</b> Introduction</a></li>
<li class="chapter" data-level="3.2" data-path="precision-standard-errors-and-confidence-intervals.html"><a href="precision-standard-errors-and-confidence-intervals.html#sampling-methods"><i class="fa fa-check"></i><b>3.2</b> Sampling methods</a></li>
<li class="chapter" data-level="3.3" data-path="precision-standard-errors-and-confidence-intervals.html"><a href="precision-standard-errors-and-confidence-intervals.html#standard-error-and-precision"><i class="fa fa-check"></i><b>3.3</b> Standard error and precision</a></li>
<li class="chapter" data-level="3.4" data-path="precision-standard-errors-and-confidence-intervals.html"><a href="precision-standard-errors-and-confidence-intervals.html#central-limit-theorem"><i class="fa fa-check"></i><b>3.4</b> Central limit theorem</a></li>
<li class="chapter" data-level="3.5" data-path="precision-standard-errors-and-confidence-intervals.html"><a href="precision-standard-errors-and-confidence-intervals.html#confidence-interval-of-the-mean"><i class="fa fa-check"></i><b>3.5</b> 95% confidence interval of the mean</a></li>
</ul></li>
<li><a href="stata-notes-1.html#stata-notes-1"><strong>3</strong> Stata notes</a>
<ul>
<li class="chapter" data-level="3.6" data-path="stata-notes-1.html"><a href="stata-notes-1.html"><i class="fa fa-check"></i><b>3.6</b> Calculating a 95% confidence interval of a mean</a></li>
</ul></li>
<li><a href="learning-activities-2.html#learning-activities-2"><strong>3</strong> Learning Activities</a></li>
<li class="chapter" data-level="4" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html"><i class="fa fa-check"></i><b>4</b> Hypothesis testing</a>
<ul>
<li class="chapter" data-level="" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#learning-objectives-3"><i class="fa fa-check"></i>Learning objectives</a></li>
<li class="chapter" data-level="" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#readings-3"><i class="fa fa-check"></i>Readings</a></li>
<li class="chapter" data-level="4.1" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#introduction-3"><i class="fa fa-check"></i><b>4.1</b> Introduction</a></li>
<li class="chapter" data-level="4.2" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#hypothesis-testing-1"><i class="fa fa-check"></i><b>4.2</b> Hypothesis testing</a></li>
<li class="chapter" data-level="4.3" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#effect-size"><i class="fa fa-check"></i><b>4.3</b> Effect size</a></li>
<li class="chapter" data-level="4.4" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#statistical-significance-and-clinical-importance"><i class="fa fa-check"></i><b>4.4</b> Statistical significance and clinical importance</a></li>
<li class="chapter" data-level="4.5" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#errors-in-significance-testing"><i class="fa fa-check"></i><b>4.5</b> Errors in significance testing</a></li>
<li class="chapter" data-level="4.6" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#confidence-intervals-in-hypothesis-testing"><i class="fa fa-check"></i><b>4.6</b> Confidence intervals in hypothesis testing</a></li>
<li class="chapter" data-level="4.7" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#one-sample-t-test"><i class="fa fa-check"></i><b>4.7</b> One-sample t-test</a></li>
<li class="chapter" data-level="4.8" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#one-and-two-tailed-tests"><i class="fa fa-check"></i><b>4.8</b> One and two tailed tests</a></li>
<li class="chapter" data-level="4.9" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#a-note-on-p-values-displayed-by-software"><i class="fa fa-check"></i><b>4.9</b> A note on P-values displayed by software</a></li>
<li class="chapter" data-level="4.10" data-path="hypothesis-testing.html"><a href="hypothesis-testing.html#decision-tree"><i class="fa fa-check"></i><b>4.10</b> Decision Tree</a></li>
</ul></li>
<li><a href="stata-notes-2.html#stata-notes-2"><strong>4</strong> Stata notes</a>
<ul>
<li class="chapter" data-level="4.11" data-path="stata-notes-2.html"><a href="stata-notes-2.html"><i class="fa fa-check"></i><b>4.11</b> One sample t-test</a></li>
</ul></li>
<li><a href="learning-activities-3.html#learning-activities-3"><strong>4</strong> Learning Activities</a></li>
<li class="chapter" data-level="5" data-path="comparing-the-means-of-two-groups.html"><a href="comparing-the-means-of-two-groups.html"><i class="fa fa-check"></i><b>5</b> Comparing the means of two groups</a>
<ul>
<li class="chapter" data-level="" data-path="comparing-the-means-of-two-groups.html"><a href="comparing-the-means-of-two-groups.html#learning-objectives-4"><i class="fa fa-check"></i>Learning objectives</a></li>
<li class="chapter" data-level="" data-path="comparing-the-means-of-two-groups.html"><a href="comparing-the-means-of-two-groups.html#readings-4"><i class="fa fa-check"></i>Readings</a></li>
<li class="chapter" data-level="5.1" data-path="comparing-the-means-of-two-groups.html"><a href="comparing-the-means-of-two-groups.html#introduction-4"><i class="fa fa-check"></i><b>5.1</b> Introduction</a></li>
<li class="chapter" data-level="5.2" data-path="comparing-the-means-of-two-groups.html"><a href="comparing-the-means-of-two-groups.html#independent-samples-t-test"><i class="fa fa-check"></i><b>5.2</b> Independent samples t-test</a></li>
<li class="chapter" data-level="5.3" data-path="comparing-the-means-of-two-groups.html"><a href="comparing-the-means-of-two-groups.html#paired-t-tests"><i class="fa fa-check"></i><b>5.3</b> Paired t-tests</a></li>
</ul></li>
<li><a href="stata-notes-3.html#stata-notes-3"><strong>5</strong> Stata notes</a>
<ul>
<li class="chapter" data-level="5.4" data-path="stata-notes-3.html"><a href="stata-notes-3.html"><i class="fa fa-check"></i><b>5.4</b> Checking data for the independent samples t-test</a></li>
<li class="chapter" data-level="5.5" data-path="stata-notes-3.html"><a href="stata-notes-3.html#independent-samples-t-test-1"><i class="fa fa-check"></i><b>5.5</b> Independent samples t-test</a></li>
<li class="chapter" data-level="5.6" data-path="stata-notes-3.html"><a href="stata-notes-3.html#checking-the-assumptions-for-a-paired-t-test"><i class="fa fa-check"></i><b>5.6</b> Checking the assumptions for a Paired t-test</a></li>
<li class="chapter" data-level="5.7" data-path="stata-notes-3.html"><a href="stata-notes-3.html#paired-t-test"><i class="fa fa-check"></i><b>5.7</b> Paired t-Test</a></li>
</ul></li>
<li><a href="learning-activities-4.html#learning-activities-4"><strong>5</strong> Learning Activities</a></li>
<li class="chapter" data-level="6" data-path="summary-statistics-for-binary-data.html"><a href="summary-statistics-for-binary-data.html"><i class="fa fa-check"></i><b>6</b> Summary statistics for binary data</a>
<ul>
<li class="chapter" data-level="" data-path="summary-statistics-for-binary-data.html"><a href="summary-statistics-for-binary-data.html#learning-objectives-5"><i class="fa fa-check"></i>Learning objectives</a></li>
<li class="chapter" data-level="" data-path="summary-statistics-for-binary-data.html"><a href="summary-statistics-for-binary-data.html#readings-5"><i class="fa fa-check"></i>Readings</a></li>
<li class="chapter" data-level="6.1" data-path="summary-statistics-for-binary-data.html"><a href="summary-statistics-for-binary-data.html#introduction-5"><i class="fa fa-check"></i><b>6.1</b> Introduction</a></li>
<li class="chapter" data-level="6.2" data-path="summary-statistics-for-binary-data.html"><a href="summary-statistics-for-binary-data.html#calculating-proportions-and-95-confidence-intervals"><i class="fa fa-check"></i><b>6.2</b> Calculating proportions and 95% confidence intervals</a></li>
<li class="chapter" data-level="6.3" data-path="summary-statistics-for-binary-data.html"><a href="summary-statistics-for-binary-data.html#hypothesis-testing-for-one-sample-proportion"><i class="fa fa-check"></i><b>6.3</b> Hypothesis testing for one sample proportion</a></li>
<li class="chapter" data-level="6.4" data-path="summary-statistics-for-binary-data.html"><a href="summary-statistics-for-binary-data.html#contingency-tables"><i class="fa fa-check"></i><b>6.4</b> Contingency tables</a></li>
<li class="chapter" data-level="6.5" data-path="summary-statistics-for-binary-data.html"><a href="summary-statistics-for-binary-data.html#a-brief-summary-of-epidemiological-study-types"><i class="fa fa-check"></i><b>6.5</b> A brief summary of epidemiological study types</a></li>
<li class="chapter" data-level="6.6" data-path="summary-statistics-for-binary-data.html"><a href="summary-statistics-for-binary-data.html#measures-of-effect-for-epidemiological-studies"><i class="fa fa-check"></i><b>6.6</b> Measures of effect for epidemiological studies</a></li>
</ul></li>
<li><a href="stata-notes-4.html#stata-notes-4"><strong>6</strong> Stata notes</a>
<ul>
<li class="chapter" data-level="6.7" data-path="stata-notes-4.html"><a href="stata-notes-4.html"><i class="fa fa-check"></i><b>6.7</b> 95% confidence intervals for proportions</a></li>
<li class="chapter" data-level="6.8" data-path="stata-notes-4.html"><a href="stata-notes-4.html#significance-test-for-single-proportion"><i class="fa fa-check"></i><b>6.8</b> Significance test for single proportion</a></li>
<li class="chapter" data-level="6.9" data-path="stata-notes-4.html"><a href="stata-notes-4.html#computing-a-relative-risk-and-its-95-confidence-interval"><i class="fa fa-check"></i><b>6.9</b> Computing a relative risk and its 95% confidence interval</a></li>
<li class="chapter" data-level="6.10" data-path="stata-notes-4.html"><a href="stata-notes-4.html#computing-an-odds-ratio-and-its-95ci"><i class="fa fa-check"></i><b>6.10</b> Computing an odds ratio and its 95%CI</a></li>
</ul></li>
<li><a href="learning-activities-5.html#learning-activities-5"><strong>6</strong> Learning Activities</a></li>
<li class="chapter" data-level="7" data-path="hypothesis-testing-for-categorical-data.html"><a href="hypothesis-testing-for-categorical-data.html"><i class="fa fa-check"></i><b>7</b> Hypothesis testing for categorical data</a>
<ul>
<li class="chapter" data-level="" data-path="hypothesis-testing-for-categorical-data.html"><a href="hypothesis-testing-for-categorical-data.html#learning-objectives-6"><i class="fa fa-check"></i>Learning objectives</a></li>
<li class="chapter" data-level="" data-path="hypothesis-testing-for-categorical-data.html"><a href="hypothesis-testing-for-categorical-data.html#readings-6"><i class="fa fa-check"></i>Readings</a></li>
<li class="chapter" data-level="7.1" data-path="hypothesis-testing-for-categorical-data.html"><a href="hypothesis-testing-for-categorical-data.html#introduction-6"><i class="fa fa-check"></i><b>7.1</b> Introduction</a></li>
<li class="chapter" data-level="7.2" data-path="hypothesis-testing-for-categorical-data.html"><a href="hypothesis-testing-for-categorical-data.html#chi-squared-test-for-independent-proportions"><i class="fa fa-check"></i><b>7.2</b> Chi-squared test for independent proportions</a></li>
<li class="chapter" data-level="7.3" data-path="hypothesis-testing-for-categorical-data.html"><a href="hypothesis-testing-for-categorical-data.html#chi-squared-tests-for-larger-than-22-table"><i class="fa fa-check"></i><b>7.3</b> Chi-squared tests for larger than 2×2 table</a></li>
<li class="chapter" data-level="7.4" data-path="hypothesis-testing-for-categorical-data.html"><a href="hypothesis-testing-for-categorical-data.html#mcnemars-test-for-categorical-paired-data"><i class="fa fa-check"></i><b>7.4</b> McNemar’s test for categorical paired data</a></li>
<li class="chapter" data-level="7.5" data-path="hypothesis-testing-for-categorical-data.html"><a href="hypothesis-testing-for-categorical-data.html#summary"><i class="fa fa-check"></i><b>7.5</b> Summary</a></li>
</ul></li>
<li><a href="stata-resources.html#stata-resources"><strong>7</strong> Stata resources</a>
<ul>
<li class="chapter" data-level="7.6" data-path="stata-resources.html"><a href="stata-resources.html"><i class="fa fa-check"></i><b>7.6</b> Pearson’s chi-squared test</a></li>
<li class="chapter" data-level="7.7" data-path="stata-resources.html"><a href="stata-resources.html#chi-squared-test-for-tables-larger-than-2-by-2"><i class="fa fa-check"></i><b>7.7</b> Chi-squared test for tables larger than 2-by-2</a></li>
<li class="chapter" data-level="7.8" data-path="stata-resources.html"><a href="stata-resources.html#mcnemars-test-for-paired-proportions"><i class="fa fa-check"></i><b>7.8</b> McNemar’s test for paired proportions</a></li>
</ul></li>
<li><a href="learning-activities-6.html#learning-activities-6"><strong>7</strong> Learning Activities</a></li>
<li class="chapter" data-level="8" data-path="correlation-and-linear-regression.html"><a href="correlation-and-linear-regression.html"><i class="fa fa-check"></i><b>8</b> Correlation and linear regression</a>
<ul>
<li class="chapter" data-level="" data-path="correlation-and-linear-regression.html"><a href="correlation-and-linear-regression.html#learning-objectives-7"><i class="fa fa-check"></i>Learning objectives</a></li>
<li class="chapter" data-level="" data-path="correlation-and-linear-regression.html"><a href="correlation-and-linear-regression.html#readings-7"><i class="fa fa-check"></i>Readings</a></li>
<li class="chapter" data-level="8.1" data-path="correlation-and-linear-regression.html"><a href="correlation-and-linear-regression.html#introduction-7"><i class="fa fa-check"></i><b>8.1</b> Introduction</a></li>
<li class="chapter" data-level="8.2" data-path="correlation-and-linear-regression.html"><a href="correlation-and-linear-regression.html#correlation"><i class="fa fa-check"></i><b>8.2</b> Correlation</a></li>
<li class="chapter" data-level="8.3" data-path="correlation-and-linear-regression.html"><a href="correlation-and-linear-regression.html#linear-regression"><i class="fa fa-check"></i><b>8.3</b> Linear regression</a></li>
<li class="chapter" data-level="8.4" data-path="correlation-and-linear-regression.html"><a href="correlation-and-linear-regression.html#obtaining-a-regression-equation-in-stata"><i class="fa fa-check"></i><b>8.4</b> Obtaining a regression equation in Stata</a></li>
<li class="chapter" data-level="8.5" data-path="correlation-and-linear-regression.html"><a href="correlation-and-linear-regression.html#multiple-linear-regression"><i class="fa fa-check"></i><b>8.5</b> Multiple linear regression</a></li>
</ul></li>
<li><a href="stata-notes-5.html#stata-notes-5"><strong>8</strong> Stata notes</a>
<ul>
<li class="chapter" data-level="8.6" data-path="stata-notes-5.html"><a href="stata-notes-5.html"><i class="fa fa-check"></i><b>8.6</b> Creating a scatter plot</a></li>
<li class="chapter" data-level="8.7" data-path="stata-notes-5.html"><a href="stata-notes-5.html#calculating-a-correlation-coefficient"><i class="fa fa-check"></i><b>8.7</b> Calculating a correlation coefficient</a></li>
<li class="chapter" data-level="8.8" data-path="stata-notes-5.html"><a href="stata-notes-5.html#fitting-a-simple-linear-regression-model"><i class="fa fa-check"></i><b>8.8</b> Fitting a simple linear regression model</a></li>
<li class="chapter" data-level="8.9" data-path="stata-notes-5.html"><a href="stata-notes-5.html#plotting-residuals-from-a-simple-linear-regression"><i class="fa fa-check"></i><b>8.9</b> Plotting residuals from a simple linear regression</a></li>
</ul></li>
<li><a href="learning-activities-7.html#learning-activities-7"><strong>8</strong> Learning Activities</a></li>
<li class="chapter" data-level="9" data-path="analysing-non-normal-data.html"><a href="analysing-non-normal-data.html"><i class="fa fa-check"></i><b>9</b> Analysing non-normal data</a>
<ul>
<li class="chapter" data-level="" data-path="analysing-non-normal-data.html"><a href="analysing-non-normal-data.html#learning-objectives-8"><i class="fa fa-check"></i>Learning objectives</a></li>
<li class="chapter" data-level="" data-path="analysing-non-normal-data.html"><a href="analysing-non-normal-data.html#readings-8"><i class="fa fa-check"></i>Readings</a></li>
<li class="chapter" data-level="9.1" data-path="analysing-non-normal-data.html"><a href="analysing-non-normal-data.html#introduction-8"><i class="fa fa-check"></i><b>9.1</b> Introduction</a></li>
<li class="chapter" data-level="9.2" data-path="analysing-non-normal-data.html"><a href="analysing-non-normal-data.html#transforming-non-normally-distributed-variables"><i class="fa fa-check"></i><b>9.2</b> Transforming non-normally distributed variables</a></li>
<li class="chapter" data-level="9.3" data-path="analysing-non-normal-data.html"><a href="analysing-non-normal-data.html#non-parametric-significance-tests"><i class="fa fa-check"></i><b>9.3</b> Non-parametric significance tests</a></li>
<li class="chapter" data-level="9.4" data-path="analysing-non-normal-data.html"><a href="analysing-non-normal-data.html#non-parametric-test-for-two-independent-samples-wilcoxon-ranked-sum-test"><i class="fa fa-check"></i><b>9.4</b> Non-parametric test for two independent samples (Wilcoxon ranked sum test)</a></li>
<li class="chapter" data-level="9.5" data-path="analysing-non-normal-data.html"><a href="analysing-non-normal-data.html#non-parametric-test-for-paired-data-wilcoxon-signed-rank-test"><i class="fa fa-check"></i><b>9.5</b> Non-parametric test for paired data (Wilcoxon signed-rank test)</a></li>
<li class="chapter" data-level="9.6" data-path="analysing-non-normal-data.html"><a href="analysing-non-normal-data.html#non-parametric-estimates-of-correlation"><i class="fa fa-check"></i><b>9.6</b> Non-parametric estimates of correlation</a></li>
<li class="chapter" data-level="9.7" data-path="analysing-non-normal-data.html"><a href="analysing-non-normal-data.html#summary-1"><i class="fa fa-check"></i><b>9.7</b> Summary</a></li>
</ul></li>
<li><a href="stata-resources-1.html#stata-resources-1"><strong>9</strong> Stata resources</a>
<ul>
<li class="chapter" data-level="9.8" data-path="stata-resources-1.html"><a href="stata-resources-1.html"><i class="fa fa-check"></i><b>9.8</b> Transforming non-normally distributed variables</a></li>
<li class="chapter" data-level="9.9" data-path="stata-resources-1.html"><a href="stata-resources-1.html#wilcoxon-ranked-sum-test"><i class="fa fa-check"></i><b>9.9</b> Wilcoxon ranked-sum test</a></li>
<li class="chapter" data-level="9.10" data-path="stata-resources-1.html"><a href="stata-resources-1.html#wilcoxon-matched-pairs-signed-rank-test"><i class="fa fa-check"></i><b>9.10</b> Wilcoxon matched-pairs signed-rank test</a></li>
<li class="chapter" data-level="9.11" data-path="stata-resources-1.html"><a href="stata-resources-1.html#estimating-rank-correlation-coefficients"><i class="fa fa-check"></i><b>9.11</b> Estimating rank correlation coefficients</a></li>
</ul></li>
<li><a href="learning-activities-8.html#learning-activities-8"><strong>9</strong> Learning Activities</a></li>
<li class="chapter" data-level="10" data-path="sample-size-estimation.html"><a href="sample-size-estimation.html"><i class="fa fa-check"></i><b>10</b> Sample size estimation</a>
<ul>
<li class="chapter" data-level="" data-path="sample-size-estimation.html"><a href="sample-size-estimation.html#learning-objectives-9"><i class="fa fa-check"></i>Learning objectives</a></li>
<li class="chapter" data-level="" data-path="sample-size-estimation.html"><a href="sample-size-estimation.html#readings-9"><i class="fa fa-check"></i>Readings</a></li>
<li class="chapter" data-level="10.1" data-path="sample-size-estimation.html"><a href="sample-size-estimation.html#introduction-9"><i class="fa fa-check"></i><b>10.1</b> Introduction</a></li>
<li class="chapter" data-level="10.2" data-path="sample-size-estimation.html"><a href="sample-size-estimation.html#sample-size-estimation-for-descriptive-studies"><i class="fa fa-check"></i><b>10.2</b> Sample size estimation for descriptive studies</a></li>
<li class="chapter" data-level="10.3" data-path="sample-size-estimation.html"><a href="sample-size-estimation.html#sample-size-estimation-for-analytical-studies"><i class="fa fa-check"></i><b>10.3</b> Sample size estimation for analytical studies</a></li>
<li class="chapter" data-level="10.4" data-path="sample-size-estimation.html"><a href="sample-size-estimation.html#detecting-the-difference-between-two-means"><i class="fa fa-check"></i><b>10.4</b> Detecting the difference between two means</a></li>
<li class="chapter" data-level="10.5" data-path="sample-size-estimation.html"><a href="sample-size-estimation.html#detecting-the-difference-between-two-proportions"><i class="fa fa-check"></i><b>10.5</b> Detecting the difference between two proportions</a></li>
<li class="chapter" data-level="10.6" data-path="sample-size-estimation.html"><a href="sample-size-estimation.html#detecting-an-association-using-a-relative-risk"><i class="fa fa-check"></i><b>10.6</b> Detecting an association using a relative risk</a></li>
<li class="chapter" data-level="10.7" data-path="sample-size-estimation.html"><a href="sample-size-estimation.html#detecting-an-association-using-an-odds-ratio"><i class="fa fa-check"></i><b>10.7</b> Detecting an association using an odds ratio</a></li>
<li class="chapter" data-level="10.8" data-path="sample-size-estimation.html"><a href="sample-size-estimation.html#factors-that-influence-power"><i class="fa fa-check"></i><b>10.8</b> Factors that influence power</a></li>
<li class="chapter" data-level="10.9" data-path="sample-size-estimation.html"><a href="sample-size-estimation.html#limitations-in-sample-size-estimations"><i class="fa fa-check"></i><b>10.9</b> Limitations in sample size estimations</a></li>
<li class="chapter" data-level="10.10" data-path="sample-size-estimation.html"><a href="sample-size-estimation.html#summary-2"><i class="fa fa-check"></i><b>10.10</b> Summary</a></li>
</ul></li>
<li><a href="stata-resources-2.html#stata-resources-2"><strong>10</strong> Stata resources</a>
<ul>
<li class="chapter" data-level="10.11" data-path="stata-resources-2.html"><a href="stata-resources-2.html"><i class="fa fa-check"></i><b>10.11</b> Sample size calculation for two independent samples t-test</a></li>
<li class="chapter" data-level="10.12" data-path="stata-resources-2.html"><a href="stata-resources-2.html#sample-size-calculation-for-paired-samples-t-test"><i class="fa fa-check"></i><b>10.12</b> Sample size calculation for paired samples t-test</a></li>
<li class="chapter" data-level="10.13" data-path="stata-resources-2.html"><a href="stata-resources-2.html#sample-size-calculation-for-difference-between-two-independent-proportions"><i class="fa fa-check"></i><b>10.13</b> Sample size calculation for difference between two independent proportions</a></li>
<li class="chapter" data-level="10.14" data-path="stata-resources-2.html"><a href="stata-resources-2.html#sample-size-calculation-with-relative-risk-and-odds-ratio"><i class="fa fa-check"></i><b>10.14</b> Sample size calculation with relative risk and odds ratio</a></li>
</ul></li>
<li><a href="learning-activities-9.html#learning-activities-9"><strong>10</strong> Learning Activities</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">PHCM9795 Foundations of Biostatistics</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="correlation-and-linear-regression" class="section level1" number="8">
<h1><span class="header-section-number">Module 8</span> Correlation and linear regression</h1>
<div id="learning-objectives-7" class="section level2 unnumbered">
<h2>Learning objectives</h2>
<p>By the end of this module you will be able to:</p>
<ul>
<li>Explore the association between two continuous variables using a scatter plot;</li>
<li>Estimate and interpret correlation coefficients;</li>
<li>Estimate and interpret parameters from a simple linear regression;</li>
<li>Decide whether a regression model is valid;</li>
<li>Test a hypothesis using regression coefficients;</li>
<li>Outline the concept of multiple regression and its role in investigative epidemiology.</li>
</ul>
</div>
<div id="readings-7" class="section level2 unnumbered">
<h2>Readings</h2>
<p><span class="citation">Kirkwood and Sterne (<a href="#ref-kirkwood_sterne01" role="doc-biblioref">2001</a>)</span>; Chapter 10.</p>
<p><span class="citation">Bland (<a href="#ref-bland15" role="doc-biblioref">2015</a>)</span>; Chapter 11.</p>
<p><span class="citation">Acock (<a href="#ref-acock10" role="doc-biblioref">2010</a>)</span>; Chapter 8.</p>
<p><span class="citation">Juul and Frydenberg (<a href="#ref-juul_frydenberg14" role="doc-biblioref">2014</a>)</span>; Section 12.1.</p>
</div>
<div id="introduction-7" class="section level2" number="8.1">
<h2><span class="header-section-number">8.1</span> Introduction</h2>
<p>In Module 5, we saw how to test whether the means from two groups are equal - in other words, whether a continuous variable is related to a categorical variable. We often want to know how closely two continuous variables are related. For example, we may want to know how closely blood cholesterol levels are related to dietary fat intake in adult men. To measure the strength of association between two continuously distributed variables, a correlation coefficient is used.</p>
<p>We may also want to know how well one continuous measurement predicts the value of another continuous measurement. For example, we may want to know how well height predicts values of lung capacity in a community of adults. A regression model allows us to use one measurement to predict another measurement.</p>
<p>Although both correlation coefficients and regression models can be used to describe the degree of association between two continuous variables, the two methods provide very different statistical information. It is important to note that both methods only measures the strengths of an association between variables and does not imply a causal relationship.</p>
</div>
<div id="correlation" class="section level2" number="8.2">
<h2><span class="header-section-number">8.2</span> Correlation</h2>
<p>We use correlation to measure the strength of a linear relationship between two variables. Before calculating a correlation coefficient, a scatter plot should first be obtained to give an understanding of the nature of the relationship between the two variables.</p>
<div id="worked-example-11" class="section level3" number="8.2.1">
<h3><span class="header-section-number">8.2.1</span> Worked Example</h3>
<p>The Stata file <code>Example_8.1.dta</code> has information about height and lung function collected from a sample of 120 adults. A random sample of adults was approached to take part in the research study, but the response rate was low at 45%. Information was collected on height (cm) and lung function, which was measured as forced vital capacity (FVC). Using the twoway command in Stata we can obtain the plot shown in Figure <a href="correlation-and-linear-regression.html#fig:scatter-plot">8.1</a>). This shows that as height increases, lung function also increases, which is as expected. One or two of the data points are separated from the rest of the data but are not so far away as to be considered outliers because they do not seem to stand out of other observations.</p>
<div class="figure"><span style="display:block;" id="fig:scatter-plot"></span>
<img src="img/mod08/scatterpng.png" alt="Association between height and lung function in 120 adults" width="66%" />
<p class="caption">
Figure 8.1: Association between height and lung function in 120 adults
</p>
</div>
</div>
<div id="correlation-coefficients" class="section level3" number="8.2.2">
<h3><span class="header-section-number">8.2.2</span> Correlation coefficients</h3>
<p>A correlation coefficient (r) describes how closely the variables are related, that is the strength of linear association between two continuous variables. The range of the coefficient is from +1 to −1 where +1 is a perfect positive association, 0 is no association and −1 is a perfect inverse association. In general, an absolute (disregarding the sign) r value below 0.3 indicates a weak association, 0.3 to &lt; 0.6 is fair association, 0.6 to &lt; 0.8 is a moderate association, and <span class="math inline">\(\ge\)</span> 0.8 indicates a strong association.</p>
<p>The coefficient is positive when large values of one variable tend to occur with large values of the other, and small values of one variable (y) tend to occur with small values of the other (x) (Figure <a href="correlation-and-linear-regression.html#fig:scatter-plot-four">8.2</a> (a and b)). For example, height and weight in healthy children or age and blood pressure.</p>
<p>The coefficient is negative when large values of one variable tend to occur with small values of the other, and small values of one variable tend to occur with large values of the other (Figure <a href="correlation-and-linear-regression.html#fig:scatter-plot-four">8.2</a> (c and d)). For example, percentage immunised against infectious diseases and under-five mortality rate.</p>
<div class="figure"><span style="display:block;" id="fig:scatter-plot-four"></span>
<img src="img/mod08/scatterplot-four-plots.png" alt="Scatter plots demonstrating strong and weak, positive and negative associations" width="66%" />
<p class="caption">
Figure 8.2: Scatter plots demonstrating strong and weak, positive and negative associations
</p>
</div>
<p>The P value associated with an r value is an estimate of whether the correlation coefficient is significantly different from zero. However, a correlation coefficient that does not have a significant P value does not imply that there is no relationship because the correlation coefficient only tests for a linear association and there may be a non-linear relationship such as a curved or irregular relationship.</p>
<p>The assumptions for using a Pearson’s correlation coefficient are that:</p>
<ul>
<li>observations are independent;</li>
<li>both variables are continuous variables;</li>
<li>the relationship between the two variables is linear.</li>
</ul>
<p>There is a further assumption that the data follow a bivariate normal distribution. This assumes: <em>y</em> follows a normal distribution for given values of <em>x</em>; and <em>x</em> follows a normal distribution for given values of <em>y</em>. This is quite a technical assumption that we do not discuss further.</p>
<p>There are two types of correlation coefficients– the correct one to use is determined by the nature of the variables as shown in Table <a href="correlation-and-linear-regression.html#tab:mod08-correlation-coefficients">8.1</a>).</p>
<table class="huxtable" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; width: 95%; margin-left: auto; margin-right: auto;  " id="tab:mod08-correlation-coefficients">
<caption style="caption-side: top; text-align: center;"><span id="tab:mod08-correlation-coefficients">Table 8.1: </span> Correlation coefficients and their application</caption><col><col><tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: bold;">Correlation coefficient</th><th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: bold;">Application</th></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: normal;">Pearson’s correlation coefficient: r</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: normal;">Both variables are continuous and a bivariate normal distribution can be assumed</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: normal;">Spearman’s rank correlation: rho</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: normal;">Bivariate normality cannot be assumed. Also useful when at least one of the variables is ordinal</td></tr>
</table>

<p>Spearman’s <span class="math inline">\(\rho\)</span> is calculated using the ranks of the data, rather than the actual values of the data. We will see further examples of such methods in Module 9, when we consider non-parametric tests, which are often based on ranks.</p>
<p>For the data in the Worked Example 8.1, using the pwcorr command in Stata gives the information shown in Output 8.1.</p>
<div id="stata-output-8.1-pwcorr-command" class="section level4" number="8.2.2.1">
<h4><span class="header-section-number">8.2.2.1</span> Stata Output 8.1: pwcorr command</h4>
<pre class="text"><code>. pwcorr Height FVC, sig

             |   Height      FVC
-------------+------------------
      Height |   1.0000 
             |
             |
         FVC |   0.6976   1.0000 
             |   0.0000
             |</code></pre>
<p>This table shows that the Pearson’s correlation coefficient between height and lung function is 0.698 with P&lt;0.001 indicating very strong evidence of a linear association between height and FVC.</p>
<p>This r value was calculated for the full data set of 120 adults who had heights ranging from 160 to 172cms. If the r value is calculated for the 60 adults with a height less than 165cms, it is much lower at 0.433 although significant at P=0.001. In general, r values are higher for a wider range of values on the x axis even though the relationship between the two variables remains the same.</p>
<p>Correlation coefficients are rarely used as important statistics in their own right because they do not fully explain the relationship between the two variables and the range of the data has an important influence on the size of the coefficient. In addition, the statistical significance of the correlation coefficient is often over interpreted because a small correlation which is of no clinical importance can become statistically significant even with a relatively small sample size. For example, a poor correlation of 0.3 will be statistically significant if the sample size is large enough.</p>
</div>
</div>
</div>
<div id="linear-regression" class="section level2" number="8.3">
<h2><span class="header-section-number">8.3</span> Linear regression</h2>
<p>The nature of a relationship between two variables is more fully described using regression. There are two principal purposes for building a regression model. The most common is to build a predictive model, for example in situations in which age and gender are used to predict normal values of characteristics such as lung size or body mass index. Normal values are the range of values that occur naturally in the general population.</p>
<p>The second purpose for using a regression model is for testing the hypothesis that there is a linear relationship between one or more explanatory variables and an outcome variable. For example, a regression model can be used to test the extent to which age predicts BMI or to test the hypothesis that two groups with a different dietary regime have significantly different BMI values after adjusting for age differences.</p>
<p>From Worked Example 8.1, Stata can be used to plot a regression line through the scatter. Figure <a href="correlation-and-linear-regression.html#fig:scatter-plot-line">8.3</a> shows the data with the line fitted.</p>
<div class="figure"><span style="display:block;" id="fig:scatter-plot-line"></span>
<img src="img/mod08/scatterplot-line-fvc-height.png" alt="Association between height and lung function in 120 adults" width="66%" />
<p class="caption">
Figure 8.3: Association between height and lung function in 120 adults
</p>
</div>
<p>The line through the plot is called the line of ‘best fit’ because the size of the deviations between the data points and the line is minimised in the calculation. The distance between each data point and the regression line is called a ‘residual’.</p>
<div id="regression-equations" class="section level3" number="8.3.1">
<h3><span class="header-section-number">8.3.1</span> Regression equations</h3>
<p>The mathematical equation for the line explains the relationship between the two variables. The equation of the regression line is as follows:</p>
<p><span class="math display">\[y = \beta_{0} + \beta_{1}x\]</span></p>
<p>This line is shown in Figure <a href="correlation-and-linear-regression.html#fig:regression-parameters">8.4</a> using the notation shown in Table <a href="correlation-and-linear-regression.html#tab:regression-notation">8.2</a>.</p>
<div class="figure"><span style="display:block;" id="fig:regression-parameters"></span>
<img src="img/mod08/regression-line-parameters.png" alt="Coefficients of a linear regression equation" width="66%" />
<p class="caption">
Figure 8.4: Coefficients of a linear regression equation
</p>
</div>
<table class="huxtable" style="border-collapse: collapse; border: 0px; margin-bottom: 2em; margin-top: 2em; width: 80%; margin-left: auto; margin-right: auto;  " id="tab:regression-notation">
<caption style="caption-side: top; text-align: center;"><span id="tab:regression-notation">Table 8.2: </span> Notation for linear regression equation</caption><col><col><tr>
<th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: bold;">Symbol</th><th style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0.4pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: bold;">Interpretation</th></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: normal;">y</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0.4pt 0pt 0pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: normal;">Observed value of the outcome variable</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 0pt; font-weight: normal;">x</td><td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 0pt 6pt 6pt; font-weight: normal;">Observed value of the explanatory variable</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 6pt 6pt 0pt; font-weight: normal;">β_0</td><td style="vertical-align: top; text-align: left; white-space: normal; padding: 6pt 0pt 6pt 6pt; font-weight: normal;">Intercept of the regression line</td></tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 6pt 6pt 0pt; font-weight: normal;">β_1</td><td style="vertical-align: top; text-align: left; white-space: normal; border-style: solid solid solid solid; border-width: 0pt 0pt 0.4pt 0pt;    padding: 6pt 0pt 6pt 6pt; font-weight: normal;">Slope of the regression line</td></tr>
</table>

<p>The intercept is the point at which the regression line intersects with the y-axis when the value of ‘x’ is zero. In most cases, the intercept does not have a biologically meaningful interpretation. The slope of the line is the unit change in the outcome variable ‘y’ with each unit change in the explanatory variable ‘x’. For any data set, the fitted regression line passes through the mean values of both the explanatory variable ‘x’ and the outcome variable ‘y’.</p>
<p>When using regression, the research question must be framed so that the explanatory variable ‘x’ and outcome variable ‘y’ are classified correctly. An important concept is that regression predicts a mean value of ‘y’ given an observed value of ‘x’ so that any error around the explanatory variable is not taken into account. For this reason, measurements that can be taken accurately, such as age and height, make good explanatory variables.</p>
</div>
<div id="fit-of-a-linear-regression-model" class="section level3" number="8.3.2">
<h3><span class="header-section-number">8.3.2</span> Fit of a linear regression model</h3>
<p>After fitting a linear regression model, it is important to know how well the model fits the observed data. One way of assessing the model fit is to compute a statistic called coefficient of determination, denoted by <span class="math inline">\(R^2\)</span>. It is the square of the Pearson correlation coefficient <span class="math inline">\(r: r^2 = R^2\)</span>. Since the range of <span class="math inline">\(r\)</span> is from −1 to 1, <span class="math inline">\(R^2\)</span> must lie between 0 and 1.</p>
<p><span class="math inline">\(R^2\)</span> can be interpreted as the proportion of variability in y that can be explained by variability in x. Hence, the following conditions may arise:</p>
<p>If <span class="math inline">\(R^2 = 1\)</span>, then all variation in y can be explained by variation of x and all data points fall on the regression line.</p>
<p>If <span class="math inline">\(R^2 = 0\)</span>, then none of the variation in y is related to x at all, and the variable x explains none of the variability in y.</p>
<p>If <span class="math inline">\(0 &lt; R^2 &lt;1\)</span>, then the variability of y can be partially explained by the variability in x. The larger the <span class="math inline">\(R^2\)</span> value, the better is the fit of the regression model.</p>
</div>
<div id="assumptions-for-linear-regression" class="section level3" number="8.3.3">
<h3><span class="header-section-number">8.3.3</span> Assumptions for linear regression</h3>
<p>Regression is robust to moderate degrees of non-normality in the variables, provided that the sample size is large enough and that there are no influential outliers. Also, the regression equation describes the relationship between the variables and this is not influenced as much by the spread of the data as the correlation coefficient is.</p>
<p>The assumptions that must be met when using linear regression are as follows:</p>
<ul>
<li>observations are independent;</li>
<li>the relationship between the explanatory and the outcome variable is linear;</li>
<li>the residuals are normally distributed.</li>
</ul>
<p>A residual is defined as the difference between the observed and predicted outcome from the regression model. If the predicted value of the outcome variable is denoted by <span class="math inline">\(\hat y\)</span> then:</p>
<p><span class="math display">\[ \text{Residual} = \text{observed} - \text{predicted} = y - \hat y\]</span></p>
<p>It is important for regression modelling that the data are collected in a period when the relationship remains constant. For example, in building a model to predict normal values for lung function the data must be collected when the participants have been resting and not exercising and people taking bronchodilator medications that influence lung capacity should be excluded. In regression, it is not so important that the variables themselves are normally distributed, but it is important that the residuals are. Scatter plots and specific diagnostic tests can be used to check the regression assumptions. Some of these will not be covered in this introductory course but will be discussed in detail in the <strong>Advanced Biostatistics</strong> course.</p>
</div>
</div>
<div id="obtaining-a-regression-equation-in-stata" class="section level2" number="8.4">
<h2><span class="header-section-number">8.4</span> Obtaining a regression equation in Stata</h2>
<p>To measure whether height is a significant predictor of forced vital capacity (FVC), we use the <code>regress</code> command in Stata.</p>
<p>Output 8.2 shows the model summary in the first part of the Stata output. The R-squared is 0.487, indicating that 48.7% of the variation in FVC is explained by height. The square root of R-squared gives us the (absolute value of) Pearson’s correlation coefficient of 0.698 as obtained in Section 8.2.</p>
<div id="output-8.2-model-summary-from-the-regress-command-in-stata" class="section level4" number="8.4.0.1">
<h4><span class="header-section-number">8.4.0.1</span> Output 8.2: Model summary from the regress command in Stata</h4>
<pre class="text"><code>. regress FVC Height

      Source |       SS           df       MS      Number of obs   =       120
-------------+----------------------------------   F(1, 118)       =    111.88
       Model |  17.5914327         1  17.5914327   Prob &gt; F        =    0.0000
    Residual |  18.5540027       118  .157237311   R-squared       =    0.4867
-------------+----------------------------------   Adj R-squared   =    0.4823
       Total |  36.1454355       119  .303743155   Root MSE        =    .39653

------------------------------------------------------------------------------
         FVC |      Coef.   Std. Err.      t    P&gt;|t|     [95% Conf. Interval]
-------------+----------------------------------------------------------------
      Height |   .1407567   .0133075    10.58   0.000     .1144042    .1671092
       _cons |  -18.87347   2.193651    -8.60   0.000     -23.2175   -14.52944
------------------------------------------------------------------------------</code></pre>
<p>The adjusted R-squared is only used when comparing multivariable models (i.e. those with different numbers of explanatory variables, including confounders), and will not be used in this course.</p>
<p>The coefficients table, the second part of the Stata output, provide the estimated regression coefficients. Stata labels the regression slope with the name of the explanatory variable and the intercept <code>_cons</code>.</p>
<p>From this output, we see that the slope is estimated as 0.141 with an estimated intercept of -18.873. Therefore, the regression equation is estimated as:</p>
<p>FVC (L) = − 18.873 + (0.141 <span class="math inline">\(\times\)</span> Height in cm)</p>
<p>This equation can be used to predict FVC for a person of a given height. For example, the predicted FVC for a person 165 cm tall is estimated as:</p>
<p>FVC = − 18.87347 + (0.1407567 <span class="math inline">\(\times\)</span> 165.0) = 4.40 L.</p>
<p>Note that for the purpose of prediction we have kept all the decimal places in the coefficients to avoid rounding error in the intermediate calculation.</p>
<p>The t-values are calculated by dividing the coefficients by their SEs and are tests of whether each coefficient is significantly different from zero. A coefficient that is significantly different from zero indicates a significant linear relationship between the variables. In this model, both the intercept and the coefficient are significantly different from zero at P &lt; 0.001.</p>
<p>In the above example, the response rate for the survey was low and there may be selection bias in that people who were healthier may have been more likely to attend so the predictive equation may not be considered representative of the general population of adults from which the sample was drawn.</p>
<p>The distribution of the residuals should always be checked. Outlying residuals can have a large effect on the slope of the model and need to be censored or brought closer to the remainder of the data to reduce their influence. The residuals can be generated using the predict command in Stata.</p>
<p>The histogram of residuals from the model is shown in Figure 8.5. They are normally distributed and indicate that there are no influential outliers so that the assumptions for regression are met.</p>
<div class="figure"><span style="display:block;" id="fig:residual-hist"></span>
<img src="img/mod08/regression-residual-histogram.png" alt="Histogram of regression residuals" width="66%" />
<p class="caption">
Figure 8.5: Histogram of regression residuals
</p>
</div>
</div>
<div id="critical-appraisal" class="section level3" number="8.4.1">
<h3><span class="header-section-number">8.4.1</span> Critical appraisal</h3>
<p>When reading the literature, it is important to be critical about how correlation coefficients are interpreted. It is a good idea to check if a scatter plot is shown to help interpret the relationship and to indicate if there are any influential outliers. Also, question whether the correlation coefficient has been calculated from a random sample and if not, what selected samples the value can be generalised to.</p>
<p>When regression is reported it is essential that the axes are correctly presented so that the equation is predictive. Thus, the explanatory variable must be presented on the x axis and the outcome on the y axis. It is also a good idea to check that all the assumptions are met. Outliers which result in a non-normal distribution of the residuals can severely bias the regression coefficients.</p>
</div>
</div>
<div id="multiple-linear-regression" class="section level2" number="8.5">
<h2><span class="header-section-number">8.5</span> Multiple linear regression</h2>
<p>In the above example, we have only used a simple linear regression model of two continuous variables. Other more complex models can be built from this e.g. if we wanted to look at the effect of gender (male vs. female) as binary indicator in the model while adjusting for the effect of height. In that case we would include both the variables in the model as explanatory variables. In the same way we can include any number of explanatory variables (both continuous and categorical) in the model: this is called a multivariable model. Multivariable models are often used for building predictive equations, for example by using age, height, gender and smoking history to predict lung function, or to adjust for confounding and detect effect modification to investigate the association between an exposure and an outcome factor.</p>
<p>Multiple regression has an important role in investigating causality in epidemiology. The exposure variable under investigation must stay in the model and the effects of other variables which can be confounders or effect-modifiers are tested. The biological, psychological or social meaning of the variables in the model and their interactions are of great importance for interpreting theories of causality.</p>
<p>Other multivariable models include binary logistic regression for use with a binary outcome variable, Cox regression for survival analyses, or Poisson regression for count data. These models, together with multiple regression, will be taught in <strong>PHCM9517: Advanced Biostatistics</strong>.</p>

</div>
</div>
<h3>References</h3>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-acock10" class="csl-entry">
Acock, Alan C. 2010. <em>A <span>Gentle Introduction</span> to <span>Stata</span>, <span>Third Edition</span></em>. 3rd edition. <span>College Station, Tex</span>: <span>Stata Press</span>.
</div>
<div id="ref-bland15" class="csl-entry">
Bland, Martin. 2015. <em>An <span>Introduction</span> to <span>Medical Statistics</span></em>. Fourth Edition. <span>Oxford, New York</span>: <span>Oxford University Press</span>.
</div>
<div id="ref-juul_frydenberg14" class="csl-entry">
Juul, Svend, and Morten Frydenberg. 2014. <em>An <span>Introduction</span> to <span>Stata</span> for <span>Health Researchers</span>, <span>Fourth Edition</span></em>. 4th edition. <span>College Station, Texas</span>: <span>Stata Press</span>.
</div>
<div id="ref-kirkwood_sterne01" class="csl-entry">
Kirkwood, Betty, and Jonathan Sterne. 2001. <em>Essentials of <span>Medical Statistics</span></em>. 2nd edition. <span>Malden, Mass</span>: <span>Wiley-Blackwell</span>.
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="learning-activities-6.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="stata-notes-5.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/08-correlation-and-regression.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["PHCM9795.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
